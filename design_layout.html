<!-- You must include this JavaScript file -->
<script src="https://assets.crowd.aws/crowd-html-elements.js"></script>

<!-- For the full list of available Crowd HTML Elements and their input/output documentation,
      please refer to https://docs.aws.amazon.com/sagemaker/latest/dg/sms-ui-template-reference.html -->

<!-- You must include crowd-form so that your task submits answers to MTurk -->
<crowd-form answer-format="flatten-objects">
<full-instructions header="Instructions">
    <p>
      In each of the subsequent screens, you will be shown a
      face image presented by a person trying to evade a face recognition system, 
      either by covering or altering some of their facial features or by presenting a mockup face instead. For each image, you need to answer two questions, in 8-30 words each. In one question you will be asked to describe what is used to mislead the face recognition system. In the other, you will be asked to describe why the presented face does not look genuine. In your answers, please use complete sentences. Also, please do not describe the natural (unaltered) characteristics of the face or provide details about the area surrounding the face. For example, if someone is holding a face picture in front of their face, do not say that the hands of the person are visible in the scene, 
      but instead focus on the face area of the image.
    </p>

    <h3>Disclaimer</h3>
    <p>
      Please, note that the validity of your answers will be checked. 
      Valid answers are expected to be relevant and meaningful. 
      AMT users with be rated based on the thoughtfulness of their answers.
    </p>
    
    <div style="display: inline-flex; align-items: stretch; justify-content: space-between;">
      <div style="width: 60%">
            <h3>Face Parts</h3>
            <p>
              Please, note that the validity of your answers will be checked. 
              Valid answers are expected to be relevant and meaningful. 
              AMT users with be rated based on the thoughtfulness of their answers.
            </p>
      </div>  
      <div style="width: 35%">
            <img width="100%" src="https://custom-images-isi.s3.us-west-1.amazonaws.com/Face+sample.png"/> 
      </div>
    </div>

    <br>
    <br>
    <h3>Sample</h3>
    <div style="display: inline-flex; align-items: stretch; justify-content: space-between;">
      <div style="width: 35%">
            <img width="100%" src="https://custom-images-isi.s3.us-west-1.amazonaws.com/sample+question+face.jpg" />
      </div> 
      <div style="width: 60%">
      <p><b>Question#1: Describe in detail the item or alteration that is being used to hide the identity of the person</b></p>
      <p style="color: #125488"><b>Your answer:  eyes are covered with opaque glasses with printed eyes, eyebrows, and blue eye shadows .</b></p>
  
       <p><b>Question#2: Describe why the item or alteration being used to hide the identity looks unnatural </b></p>
        <p style="color: #125488"><b>Your answer: it looks unnatural because of the flatness of the eyes and the mismatch between the eyebrows and 
              mismatch between the depth of the eye region and the cheeks.</b></p>
      </div>
    </div>
</full-instructions>

<short-instructions>
      <p>
            In each of the subsequent screens, you will be shown a
            face image presented by a person trying to evade a face recognition system, 
            either by covering or altering some of their facial features or by presenting a mockup face instead. For each image, you need to answer two questions, in 8-30 words each. In one question you will be asked to describe what is used to mislead the face recognition system. In the other, you will be asked to describe why the presented face does not look genuine. In your answers, please use complete sentences. Also, please do not describe the natural (unaltered) characteristics of the face or provide details about the area surrounding the face. For example, if someone is holding a face picture in front of their face, do not say that the hands of the person are visible in the scene, 
            but instead focus on the face area of the image.
          </p>
      
          <h3>Disclaimner</h3>
          <p>
            Please, note that the validity of your answers will be checked. 
            Valid answers are expected to be relevant and meaningful. 
            AMT users with be rated based on the thoughtfulness of their answers.
          </p>
          
          <h3>Face Parts</h3>
          <p>
            Please, note that the validity of your answers will be checked. 
            Valid answers are expected to be relevant and meaningful. 
            AMT users with be rated based on the thoughtfulness of their answers.
          </p>
          <img width="100%" height="auto" src="https://custom-images-isi.s3.us-west-1.amazonaws.com/Face+sample.png"/>
      
    </short-instructions>
    <!-- Your image file URLs will be substituted for the "image_url" variable below
          when you publish a batch with a CSV input file containing multiple image file URLs.
          To preview the element with an example image, try setting the src attribute to
          "https://s3.amazonaws.com/cv-demo-images/basketball-outdoor.jpg" -->
    <!-- <img src="http://d3l6xw9j1xm30q.cloudfront.net/ID_8bd370f99ca265972ae9d907502ae87d5d71568c_x9367b48_FACE_WITHOUT_GLASS_1_m50010001Q94.jpg" style="max-width: 100%; max-height: 250px;  pointer-events: none" />-->
    <!-- <img src=${image_id} style="max-width: 100%; max-height: 250px;  pointer-events: none" /> -->
    <!-- <li style="color:rgb(0,0,255);"><strong>Suggested words:</strong> ${suggested_words}</li> -->
      <p style="display: none" id="time_states"></p>
      <p style="display: none" id="current_page">1</p>
      <!-- <div id="question toggle">
            <button type="button" onclick="nextPage()" id="next">Next</button>
      <button type="button" onclick="prevPage()" id="prev">Prev</button>
      </div> -->
      <!-- <p>Time remaining: <strong id="timer"></strong></p> -->
      <!-- <div id="time-up">
            <p>Your Time for this question is up!</p>
      </div> -->
      <div id="instructions" style="text-align: justify;">
            <center><h1>Instructions</h1></center>
            <p>
                  In each of the subsequent screens, you will be shown a
                  face image presented by a person trying to evade a face recognition system, 
                  either by covering or altering some of their facial features or by presenting a mockup face instead. For each image, you need to answer two questions, in 8-30 words each. In one question you will be asked to describe what is used to mislead the face recognition system. In the other, you will be asked to describe why the presented face does not look genuine. In your answers, please use complete sentences. Also, please do not describe the natural (unaltered) characteristics of the face or provide details about the area surrounding the face. For example, if someone is holding a face picture in front of their face, do not say that the hands of the person are visible in the scene, 
                  but instead focus on the face area of the image.
                </p>
            
                <h3>Disclaimer</h3>
                <p>
                  Please, note that the validity of your answers will be checked. 
                  Valid answers are expected to be relevant and meaningful. 
                  AMT users with be rated based on the thoughtfulness of their answers.
                </p>
                
                <div style="display: inline-flex; align-items: stretch; justify-content: space-between;">
                  <div style="width: 60%">
                        <h3>Face Parts</h3>
                        <p>
                          Please, note that the validity of your answers will be checked. 
                          Valid answers are expected to be relevant and meaningful. 
                          AMT users with be rated based on the thoughtfulness of their answers.
                        </p>
                  </div>  
                  <div style="width: 35%">
                        <img width="100%" src="https://custom-images-isi.s3.us-west-1.amazonaws.com/Face+sample.png"/> 
                  </div>
            </div>
            <br/>
            <center><button style="font-size: 12px;
                  line-height: 20px;
                  letter-spacing: 0.06px;
                  padding: 0 20px 0 20px;
                  height: 42px;
                  margin: 0 8px 0 0;
                  background-color: #ff9900;
                  color: white;
                  border-color: #125488;
                  box-sizing: border-box;" onclick="instructionContinue()">Continue</button></center>

      </div>
      <div id="sample" style="display: none;">
            <center><h1>Sample</h1></center>
            <div style="border-color: black; margin: 1%; padding: 1%;">
                  <div style="display: inline-flex; align-items: center;">
                        <div style="width: 40%">
                        <h3>Instructions:</h3>
                        <ul>
                              <li>Use complete sentences in your answers.</li>
                              <li>Your answer should be within 8-30 words.</li>
                              <li>Do not describe unaltered face parts in the image or parts of the image surrounding the face region.</li>
                              <li>The opposite diagram shows the face parts for your reference</li>
                        </ul>
                        </div>  
                        <div style="width: 35%">
                              <img width="100%" height="auto" src="https://custom-images-isi.s3.us-west-1.amazonaws.com/Face+sample.png"/> 
                        </div>
                  </div>
            </div>
            <div style="display: inline-flex; justify-content: space-between;">
            <div style="width: 35%">
                  <img width="70%" style="margin-left: 10%;" height="auto" src="https://custom-images-isi.s3.us-west-1.amazonaws.com/sample+question+face.jpg" />
            </div> 
            <div style="width: 60%">
            <p><b>Question#1: Describe in detail the item or alteration that is being used to hide the identity of the person</b></p>
            <p style="color: #125488"><b>Your answer:  eyes are covered with opaque glasses with printed eyes, eyebrows, and blue eye shadows .</b></p>
      
            <p><b>Question#2: Describe why the item or alteration being used to hide the identity looks unnatural </b></p>
            <p style="color: #125488"><b>Your answer: it looks unnatural because of the flatness of the eyes and the mismatch between the eyebrows and 
                  mismatch between the depth of the eye region and the cheeks.</b></p>
            </div>
      </div>
            <center><button style="font-size: 12px;
                  line-height: 20px;
                  letter-spacing: 0.06px;
                  padding: 0 20px 0 20px;
                  height: 42px;
                  margin: 0 8px 0 0;
                  background-color: #ff9900;
                  color: white;
                  border-color: #125488;
                  box-sizing: border-box;" onclick="sampleContinue()">Continue</button></center>
      </div>
      <!-- <div id="q1" class="question"> -->
      <div id="q1" class="question" style="display: none">
            <div style="border-color: black; margin: 1%; padding: 1%;">
                  <div style="display: inline-flex; align-items: center;">
                        <div style="width: 40%">
                        <h3>Instructions:</h3>
                        <ul>
                              <li>Use complete sentences in your answers.</li>
                              <li>Your answer should be within 8-30 words.</li>
                              <li>Do not describe unaltered face parts in the image or parts of the image surrounding the face region.</li>
                              <li>The opposite diagram shows the face parts for your reference</li>
                        </ul>
                        </div>  
                        <div style="width: 35%">
                              <img width="100%" height="auto" src="https://custom-images-isi.s3.us-west-1.amazonaws.com/Face+sample.png"/> 
                        </div>
                  </div>
            </div>
            <div style="display: inline-flex; justify-content: space-between;width: 100%;">
            <div style="width: 35%">
                  <img width="70%" style="margin-left: 10%;" height="auto" src="{image_id}" />
            </div> 
            <div style="width: 60%">
            <p><b>Question#1: Describe in detail the item or alteration that is being used to hide the identity of the person</b></p>
            <p style="color: #125488"><b>Your answer:</b></p>
            <crowd-text-area name="question1" rows="4" required></crowd-text-area>
            <p><b>Question#2: Describe why the item or alteration being used to hide the identity looks unnatural </b></p>
            <p style="color: #125488"><b>Your answer:</b></p>
            <crowd-text-area name="question2" rows="4" required></crowd-text-area>
            </div>
      </div>  
      <!-- <div id="q2" class="question">    
            <p> <strong>Question#2: </strong>Is this a dog ?? </p>
            <crowd-input label="Your answer to Question#2" name="S2" required></crowd-input>
      </div>  
      <div id="q3" class="question">
            <p> <strong>Question#3:</strong> What is the color of the animal ??
            <crowd-radio-group required>
            <crowd-radio-button name="color" value="white">White</crowd-radio-button>
            <crowd-radio-button name="color" value="black">Black</crowd-radio-button>
            </crowd-radio-group>
      </div>
      <div id="q4" class="question">
            <p> <strong>Question#4:</strong> Describe the animal features ( fur shape, posture of the animal, etc. ) ??</p>
            <crowd-text-area name="description" rows="4" required></crowd-text-area>
      </div>
      <div id="q5" class="question">
            <crowd-checkbox name="cat-dog" required><strong>Question #5: </strong>Does the image looks both like a cat and dog ?? </crowd-checkbox>
      </div> -->
</crowd-form>
<script>
      function sampleContinue() {
            let q1 = document.getElementById("q1");
            q1.style.display = "block";
            let sample = document.getElementById("sample")
            sample.style.display = "none";
      }
      function instructionContinue() {
            let instruction = document.getElementById("instructions");
            instruction.style.display = "none";
            let sample = document.getElementById("sample")
            sample.style.display = "block";
      }
      const NUM_QUESTIONS = 5;
      var timer;
      function setNext(disabled) {
            let next_btn = document.getElementById("next");
            next_btn.disabled = disabled;
      }
      function setPrev(disabled) {
            let prev_btn = document.getElementById("prev");
            prev_btn.disabled = disabled;
      }
      function getCurrentPage() {
             let current_page = document.getElementById("current_page").innerHTML;
             current_page = Number.parseInt(current_page);
             return current_page;
      }
      function setCurrentPage(page) {
             let current_page = document.getElementById("current_page");
             current_page.innerHTML = page.toString();
             let questions = document.getElementsByClassName("question");
             let time_states = document.getElementById("time_states");
             time_states = JSON.parse(time_states.innerHTML);
             for(let i=0;i<questions.length; i += 1) {
                   const question = questions[i];
                   if(question.id != "q" + page.toString()) {
                        question.style.display = 'none';
                   } else if(time_states[page] > 0) {
                         question.style.display = 'block';
                        document.getElementById("time-up").style.display = "none";
                   } else {
                        question.style.display = 'none';
                        document.getElementById("time-up").style.display = "block";
                   }
             }
             setNext(page == NUM_QUESTIONS);
             setPrev(page == 1);
      }
      function setTimeState(page) {
            let timer = document.getElementById("timer").innerHTML;
            timer = timer.split(':');
            let mins = Number.parseInt(timer[0])
            let secs = Number.parseInt(timer[1])
            let time_states = document.getElementById("time_states");
            timeStates = JSON.parse(time_states.innerHTML); 
            timeStates[page] = mins*60 + secs;
            time_states.innerHTML = JSON.stringify(timeStates);
      }
      function setTimer() {
            clearInterval(timer);
            let current_page = getCurrentPage();
            let time_states = document.getElementById("time_states");
            time_states = JSON.parse(time_states.innerHTML); 
            var init_time = time_states[current_page];
            let countDown = () => {
                  if(init_time < 0) {
                        setTimeState(current_page);
                        setCurrentPage(current_page);
                        clearInterval(timer);
                        init_time = 0;
                  }
                  mins = Math.floor(init_time / 60);
                  secs = init_time % 60;
                  let timerEle = document.getElementById("timer");
                  timerEle.innerHTML = mins.toString() + ":" + secs.toString();
                  init_time -= 1;
            };
            countDown();
            timer = setInterval(countDown, 1000);
      }
      function nextPage() {
            let current_page = getCurrentPage();
            setTimeState(current_page);
            setCurrentPage(current_page + 1);
            setTimer();
      }
      function prevPage() {
            let current_page = getCurrentPage();
            setTimeState(current_page);
            setCurrentPage(current_page - 1);
            setTimer();
      }
      let time_states = document.getElementById("time_states");
      let time_State = []
      for(let i=0;i<=NUM_QUESTIONS; i += 1) {
            time_State[i] = 20;
      }
      time_states.innerHTML = JSON.stringify(time_State);
      // setCurrentPage(1);
      // setTimer();
 </script>